<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.13">
  <compounddef id="structwickr__stream__ctx" kind="struct" language="C++" prot="public">
    <compoundname>wickr_stream_ctx</compoundname>
    <includes refid="stream__cipher_8h" local="no">stream_cipher.h</includes>
      <sectiondef kind="public-attrib">
      <memberdef kind="variable" id="structwickr__stream__ctx_1a14ef322bbeec579ded7f35c5aeb0d3fa" prot="public" static="no" mutable="no">
        <type><ref refid="structwickr__crypto__engine" kindref="compound">wickr_crypto_engine_t</ref></type>
        <definition>wickr_stream_ctx::engine</definition>
        <argsstring></argsstring>
        <name>engine</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>crypto engine to be used for cipher operations, as well as key evolution using HMAC </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/crypto/stream_cipher.h" line="84" column="1" bodyfile="src/crypto/stream_cipher.h" bodystart="84" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structwickr__stream__ctx_1a3598b3c0415d13fafab6633f8c00a3c8" prot="public" static="no" mutable="no">
        <type><ref refid="structwickr__stream__key" kindref="compound">wickr_stream_key_t</ref> *</type>
        <definition>wickr_stream_ctx::key</definition>
        <argsstring></argsstring>
        <name>key</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>the current stream key that the stream context is using for encryption or decryption depending on directoin the stream key will change over the course of packet encoding due to it&apos;s evolutions </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/crypto/stream_cipher.h" line="85" column="1" bodyfile="src/crypto/stream_cipher.h" bodystart="85" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structwickr__stream__ctx_1a67c5066e87dbdc026358563daa51f174" prot="public" static="no" mutable="no">
        <type><ref refid="structwickr__stream__iv" kindref="compound">wickr_stream_iv_t</ref> *</type>
        <definition>wickr_stream_ctx::iv_factory</definition>
        <argsstring></argsstring>
        <name>iv_factory</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>the iv generator that this stream is using to create iv&apos;s </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/crypto/stream_cipher.h" line="86" column="1" bodyfile="src/crypto/stream_cipher.h" bodystart="86" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structwickr__stream__ctx_1abf2c6ab54e1663e6a47e310fd68b3b3f" prot="public" static="no" mutable="no">
        <type>uint64_t</type>
        <definition>wickr_stream_ctx::last_seq</definition>
        <argsstring></argsstring>
        <name>last_seq</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>the most recent sequence number that successfully encrypted or decrypted a packet </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/crypto/stream_cipher.h" line="87" column="1" bodyfile="src/crypto/stream_cipher.h" bodystart="87" bodyend="-1"/>
      </memberdef>
      <memberdef kind="variable" id="structwickr__stream__ctx_1a34c622c3ca61348321261ee7a9c3ff91" prot="public" static="no" mutable="no">
        <type>wickr_stream_direction</type>
        <definition>wickr_stream_ctx::direction</definition>
        <argsstring></argsstring>
        <name>direction</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>the direction of this stream context. direction can either be encoding or decoding </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="src/crypto/stream_cipher.h" line="88" column="1" bodyfile="src/crypto/stream_cipher.h" bodystart="88" bodyend="-1"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
<para>A context that is used for encrypting or decrypting a sequenced stream of data packets The stream context manages the state of stream operations including key evolution management based on the sequence number of the being encrypted / decrypted. The stream context is assigned a direction, and can only be used for encoding OR decoding of packets, and not both. </para>    </briefdescription>
    <detaileddescription>
<para>Key evolution happens based on sequence number. Keyn+1 is generated by HMAC(Keyn, evolution_key). Gaps in sequence numbers are allowed and if the key needs to evolove multiple times, it will do so in a loop until the key is current, and data ciphering is possible. Sequence numbers can NOT go backwards due to the evolution&apos;s use of HMAC. Once Keyn+1 is generated, it is not possible to go back and calculate Keyn. </para>    </detaileddescription>
    <collaborationgraph>
      <node id="216">
        <label>wickr_ecdsa_result</label>
        <link refid="structwickr__ecdsa__result"/>
        <childnode refid="210" relation="usage">
          <edgelabel>curve</edgelabel>
        </childnode>
        <childnode refid="217" relation="usage">
          <edgelabel>digest_mode</edgelabel>
        </childnode>
        <childnode refid="206" relation="usage">
          <edgelabel>sig_data</edgelabel>
        </childnode>
      </node>
      <node id="209">
        <label>wickr_cipher_key</label>
        <link refid="structwickr__cipher__key"/>
        <childnode refid="206" relation="usage">
          <edgelabel>key_data</edgelabel>
        </childnode>
        <childnode refid="207" relation="usage">
          <edgelabel>cipher</edgelabel>
        </childnode>
      </node>
      <node id="218">
        <label>wickr_stream_key</label>
        <link refid="structwickr__stream__key"/>
        <childnode refid="209" relation="usage">
          <edgelabel>cipher_key</edgelabel>
        </childnode>
        <childnode refid="206" relation="usage">
          <edgelabel>evolution_key</edgelabel>
        </childnode>
      </node>
      <node id="215">
        <label>wickr_kdf_algo</label>
        <link refid="structwickr__kdf__algo"/>
      </node>
      <node id="208">
        <label>wickr_crypto_engine</label>
        <link refid="structwickr__crypto__engine"/>
        <childnode refid="209" relation="usage">
          <edgelabel>wickr_crypto_engine_cipher_key_random</edgelabel>
        </childnode>
        <childnode refid="210" relation="usage">
          <edgelabel>default_curve</edgelabel>
        </childnode>
        <childnode refid="211" relation="usage">
          <edgelabel>wickr_crypto_engine_cipher_encrypt</edgelabel>
        </childnode>
        <childnode refid="206" relation="usage">
          <edgelabel>wickr_crypto_engine_hmac_create</edgelabel>
          <edgelabel>wickr_crypto_engine_cipher_decrypt</edgelabel>
          <edgelabel>wickr_crypto_engine_crypto_random</edgelabel>
          <edgelabel>wickr_crypto_engine_digest</edgelabel>
          <edgelabel>wickr_crypto_engine_ecdh_gen_key</edgelabel>
          <edgelabel>wickr_crypto_engine_digest_file</edgelabel>
        </childnode>
        <childnode refid="207" relation="usage">
          <edgelabel>default_cipher</edgelabel>
        </childnode>
        <childnode refid="212" relation="usage">
          <edgelabel>wickr_crypto_engine_ec_key_import</edgelabel>
          <edgelabel>wickr_crypto_engine_ec_rand_key</edgelabel>
        </childnode>
        <childnode refid="213" relation="usage">
          <edgelabel>wickr_crypto_kdf_meta</edgelabel>
          <edgelabel>wickr_crypto_kdf_gen</edgelabel>
        </childnode>
        <childnode refid="216" relation="usage">
          <edgelabel>wickr_crypto_engine_ec_sign</edgelabel>
        </childnode>
      </node>
      <node id="204">
        <label>wickr_stream_ctx</label>
        <link refid="structwickr__stream__ctx"/>
        <childnode refid="205" relation="usage">
          <edgelabel>iv_factory</edgelabel>
        </childnode>
        <childnode refid="208" relation="usage">
          <edgelabel>engine</edgelabel>
        </childnode>
        <childnode refid="218" relation="usage">
          <edgelabel>key</edgelabel>
        </childnode>
      </node>
      <node id="207">
        <label>wickr_cipher</label>
        <link refid="structwickr__cipher"/>
      </node>
      <node id="205">
        <label>wickr_stream_iv</label>
        <link refid="structwickr__stream__iv"/>
        <childnode refid="206" relation="usage">
          <edgelabel>seed</edgelabel>
        </childnode>
        <childnode refid="207" relation="usage">
          <edgelabel>cipher</edgelabel>
        </childnode>
        <childnode refid="208" relation="usage">
          <edgelabel>engine</edgelabel>
        </childnode>
      </node>
      <node id="214">
        <label>wickr_kdf_meta</label>
        <link refid="structwickr__kdf__meta"/>
        <childnode refid="206" relation="usage">
          <edgelabel>salt</edgelabel>
          <edgelabel>info</edgelabel>
        </childnode>
        <childnode refid="215" relation="usage">
          <edgelabel>algo</edgelabel>
        </childnode>
      </node>
      <node id="210">
        <label>wickr_ec_curve</label>
        <link refid="structwickr__ec__curve"/>
      </node>
      <node id="217">
        <label>wickr_digest</label>
        <link refid="structwickr__digest"/>
      </node>
      <node id="213">
        <label>wickr_kdf_result</label>
        <link refid="structwickr__kdf__result"/>
        <childnode refid="206" relation="usage">
          <edgelabel>hash</edgelabel>
        </childnode>
        <childnode refid="214" relation="usage">
          <edgelabel>meta</edgelabel>
        </childnode>
      </node>
      <node id="211">
        <label>wickr_cipher_result</label>
        <link refid="structwickr__cipher__result"/>
        <childnode refid="206" relation="usage">
          <edgelabel>cipher_text</edgelabel>
          <edgelabel>iv</edgelabel>
          <edgelabel>auth_tag</edgelabel>
        </childnode>
        <childnode refid="207" relation="usage">
          <edgelabel>cipher</edgelabel>
        </childnode>
      </node>
      <node id="206">
        <label>wickr_buffer</label>
        <link refid="structwickr__buffer"/>
      </node>
      <node id="212">
        <label>wickr_ec_key</label>
        <link refid="structwickr__ec__key"/>
        <childnode refid="210" relation="usage">
          <edgelabel>curve</edgelabel>
        </childnode>
        <childnode refid="206" relation="usage">
          <edgelabel>pub_data</edgelabel>
          <edgelabel>pri_data</edgelabel>
        </childnode>
      </node>
    </collaborationgraph>
    <location file="src/crypto/stream_cipher.h" line="83" column="1" bodyfile="src/crypto/stream_cipher.h" bodystart="83" bodyend="89"/>
    <listofallmembers>
      <member refid="structwickr__stream__ctx_1a34c622c3ca61348321261ee7a9c3ff91" prot="public" virt="non-virtual"><scope>wickr_stream_ctx</scope><name>direction</name></member>
      <member refid="structwickr__stream__ctx_1a14ef322bbeec579ded7f35c5aeb0d3fa" prot="public" virt="non-virtual"><scope>wickr_stream_ctx</scope><name>engine</name></member>
      <member refid="structwickr__stream__ctx_1a67c5066e87dbdc026358563daa51f174" prot="public" virt="non-virtual"><scope>wickr_stream_ctx</scope><name>iv_factory</name></member>
      <member refid="structwickr__stream__ctx_1a3598b3c0415d13fafab6633f8c00a3c8" prot="public" virt="non-virtual"><scope>wickr_stream_ctx</scope><name>key</name></member>
      <member refid="structwickr__stream__ctx_1abf2c6ab54e1663e6a47e310fd68b3b3f" prot="public" virt="non-virtual"><scope>wickr_stream_ctx</scope><name>last_seq</name></member>
    </listofallmembers>
  </compounddef>
</doxygen>
